<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
		xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
		layout:decorate="~{layouts/mypage_layout}">
		<main class="content-wrapper" layout:fragment="content" style="padding: 10px;">
			<style>
				.gradient-bg {
					background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				}
				.card-shadow {
					box-shadow: 0 10px 25px rgba(0,0,0,0.3);
				}
				.status-indicator {
					position: relative;
					overflow: hidden;
				}
				.status-indicator::before {
					content: '';
					position: absolute;
					top: 0;
					left: -100%;
					width: 100%;
					height: 100%;
					background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
					animation: shimmer 2s infinite;
				}
				@keyframes shimmer {
					0% { left: -100%; }
					100% { left: 100%; }
				}
				.product-item {
					transition: all 0.3s ease;
				}
				.product-item:hover {
					transform: translateY(-2px);
					box-shadow: 0 5px 15px rgba(0,0,0,0.3);
				}
				.content-container {
					max-width: 1200px;
					min-height: 60vh;
					margin: 0 auto;
				}
			</style>
			<!-- Main Content -->
			<div class="content-container justify-content-center">
				<th:block th:replace="fragments/mypageTabs :: mypageTabs(${activeMenu})"></th:block>

				<div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
					<div class="flex-1">
						<div class="flex items-center justify-between mb-2">
							<h2 class="text-2xl font-bold text-gray-800">ì£¼ë¬¸ ë‚´ì—­</h2>
						</div>
					</div>
				</div>
				<!-- ì£¼ë¬¸ ì •ë³´ ì¹´ë“œ -->
				<th:block th:if="${order != null and !#lists.isEmpty(order)}">
					<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
						<th:block th:each="rs, rsStat : ${order}">
							<div class="bg-white rounded-2xl card-shadow p-6 product-item">
								
								<!-- ì£¼ë¬¸ì¼ì -->
								<div class="items-center text-gray-600 mb-2">
									<i class="far fa-calendar-alt mr-2"></i>
									<span th:text="'ì£¼ë¬¸ì¼ì: ' + ${rs.orderPayDt.substring(0, 10)}"></span>
								</div>
					
								<!-- ìƒí’ˆ (ëŒ€í‘œ 1ê±´ë§Œ) -->
								<th:block th:if="${!#lists.isEmpty(rs.productList)}">
									<th:block th:with="p=${rs.productList[0]}">
										<div class="bg-gray-100 rounded-lg p-4">
											<h4 class="font-semibold text-gray-800 mb-2">
												<i class="fa-solid fa-box text-green-500"></i>
												<span class="text-gray-600">ìƒí’ˆëª…: </span>
												<span th:text="
													${p.menuDay.substring(0,4)} + '.' +
													${p.menuDay.substring(4,6)} + '.' +
													${p.menuDay.substring(6,8)} +
													' ì™¸ ' + ${#lists.size(rs.productList)} + 'ê±´'
												"></span>
											</h4>
											<h4 class="font-semibold text-gray-800">
												<i class="fa-solid fa-receipt text-gray-400"></i>
												<span class="text-gray-600">ì£¼ë¬¸ë²ˆí˜¸: </span>
												<span th:text="${rs.orderNo}"></span>
											</h4>
											<div class="flex justify-between items-center mt-4 pt-2 border-t">
												<span class="text-sm text-gray-500">ê²°ì œê¸ˆì•¡</span>
												<span class="text-lg font-bold text-gray-900" th:text="${#numbers.formatInteger(rs.totalAmount,3,'COMMA')} +'ì›'"></span>
											</div>
											
											<div class="mt-3 flex justify-end">
												<button type="button" class="text-sm font-bold text-green-600 hover:underline" th:data-order-no="${rs.orderNo}" onclick="fnOrderDetail(this.dataset.orderNo)">
													ì£¼ë¬¸ ìƒì„¸ ë³´ê¸° >
												</button>
											</div>
										</div>
									</th:block>
								</th:block>
							</div>
						</th:block>
					</div>
				</th:block>
				<th:block th:if="${order == null or #lists.isEmpty(order)}">
					<div class="bg-white rounded-2xl card-shadow p-10 text-center">
						<div class="flex justify-center mb-4">
							<div class="w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center">
								<i class="fas fa-box-open text-2xl text-gray-400"></i>
							</div>
						</div>
						<h3 class="text-lg font-semibold text-gray-700 mb-2">
							ì•„ì§ ì£¼ë¬¸ ë‚´ì—­ì´ ì—†ì–´ìš”
						</h3>
						<p class="text-sm text-gray-500 mb-6">
							ë°˜ì°¬ì´ ìƒê°ë‚  ë•Œ ì–¸ì œë“ ì§€ ì£¼ë¬¸í•´ ì£¼ì„¸ìš” ğŸ˜Š
						</p>
						<a href="/order"
						   class="inline-flex items-center px-6 py-3 bg-green-600 text-white text-sm font-semibold rounded-full hover:bg-green-700 transition">
							ë©”ë‰´ ë³´ëŸ¬ê°€ê¸°
						</a>
					</div>
				</th:block>
			</div>
			<script>
				fnOrderDetail = function (orderNo){
					const form = document.createElement('form');
					form.method = 'POST';
					form.action = '/mypage/orderDetail';
				
					const input = document.createElement('input');
					input.type = 'hidden';
					input.name = 'orderNo';
					input.value = orderNo;
				
					form.appendChild(input);
					document.body.appendChild(form);
					form.submit();
				}
			</script>
		</main>
</html>