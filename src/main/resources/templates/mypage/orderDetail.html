<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
		xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
		layout:decorate="~{layouts/mypage_layout}">
		<main class="content-wrapper" layout:fragment="content" style="padding: 10px;">
			<style>
				body {
					font-family: 'Noto Sans KR', sans-serif;
				}
				.gradient-bg {
					background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				}
				.card-shadow {
					box-shadow: 0 10px 25px rgba(0,0,0,0.3);
				}
				.status-indicator {
					position: relative;
					overflow: hidden;
				}
				.status-indicator::before {
					content: '';
					position: absolute;
					top: 0;
					left: -100%;
					width: 100%;
					height: 100%;
					background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
					animation: shimmer 2s infinite;
				}
				@keyframes shimmer {
					0% { left: -100%; }
					100% { left: 100%; }
				}
				.product-item {
					transition: all 0.3s ease;
				}
				.product-item:hover {
					transform: translateY(-2px);
					box-shadow: 0 5px 15px rgba(0,0,0,0.5);
				}
			</style>
			<!-- Main Content -->
			<div class="container mx-auto px-4">
				<!-- ì£¼ë¬¸ ì •ë³´ ì¹´ë“œ -->
				<th:block th:if="${order != null and !#lists.isEmpty(order)}">
					<div class="bg-white rounded-2xl card-shadow p-6 mb-8">
						<div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
							<div class="flex-1">
								<div class="flex items-center justify-between mb-2">
									<h2 class="text-2xl font-bold text-gray-800">ì£¼ë¬¸ ë‚´ì—­</h2>
								</div>
								<div class="items-center text-gray-600">
									<span class="items-center">
										<i class="far fa-calendar-alt mr-2"></i><span th:text="'ì£¼ë¬¸ì¼ì: ' + ${order.orderPayDt.substring(0, 10)}"></span>
									</span>
									<br>
									<th:block th:if="${order.orderStatus == '0001'}">
										<span class="items-center">
											<i class="fas fa-receipt mr-2"></i><span style="text-decoration: line-through; color:red" th:text="'ì£¼ë¬¸ë²ˆí˜¸: ' + ${order.orderNo}"></span><br>
											<span style="color: red;">ê²°ì œ ì·¨ì†Œëœ ì£¼ë¬¸ì…ë‹ˆë‹¤.</span>
										</span>
									</th:block>
									<th:block th:if="${order.orderStatus == '0000'}">
										<span class="items-center">
											<i class="fas fa-receipt mr-2"></i><span th:text="'ì£¼ë¬¸ë²ˆí˜¸: ' + ${order.orderNo}"></span>
										</span>
									</th:block>
									<div th:if="${refund != null && refund.status == '0000'}">
										<span class="items-center">
											<span style="color: red;">í™˜ë¶ˆ ì‹ ì²­ëœ ì£¼ë¬¸ì…ë‹ˆë‹¤.</span>
										</span>
									</div>
								</div>
							</div>
						</div>
						<th:block th:each="rs,rsStat : ${order.productList}">
							<div class="space-y-4">
								<div class="product-item bg-gray-50 rounded-lg p-4 mb-4">
									<div class="items-center justify-between">
										<h4 class="font-semibold text-gray-800 mb-2 text-sm">
											<span th:text="${rs.menuDay.substring(0,4)} + '.' + ${rs.menuDay.substring(4,6)} + '.' + ${rs.menuDay.substring(6,8)}"></span>
											<span class="text-right inline-block float-right">
												<th:block th:if="${rs.orderSet == '1000'}"> ì¼ë°˜ì„¸íŠ¸(ì¶”ê°€)</th:block>
												<th:block th:if="${rs.orderSet == '2000'}"> 1ì¸ë¶„ì„¸íŠ¸</th:block>
												<th:block th:if="${rs.orderSet == '3000'}"> ì¼ë°˜ì„¸íŠ¸</th:block>
												<th:block th:if="${rs.delivTime == '1000'}"> ì˜¤ì „ë°°ë‹¬</th:block>
												<th:block th:if="${rs.delivTime == '2000'}"> ì˜¤í›„ë°°ë‹¬</th:block>
											</span>
										</h4>
										<div th:class="${rs.orderSet == '1000'} ? 'md:grid md:grid-cols-3 md:gap-2 text-m text-gray-600' : 'grid grid-cols-2 md:grid-cols-3 gap-2 text-m text-gray-600'">
											<th:block th:if="${rs.orderSet == '1000'}">
												<th:block th:each="msg,msgStat : ${#strings.setSplit(rs.menuMsg,'|')}">
													<th:block th:if="${#strings.substring(msg,0,1) == '!'}">
														<div class="block md:inline">
															<span class="text-red-600 text-sm" th:text="${#strings.substring(msg,1)}"></span>
															<span class="text-red-600 text-sm" th:text="'('+${#strings.arraySplit(rs.menuMsgDetail ?: '', '|')[msgStat.index]}+'ê°œ)'"></span>
														</div>
													</th:block>
													<th:block th:if="${#strings.substring(msg,0,1) != '!'}">
														<div class="block md:inline">
															<span class="text-sm" th:text="${msg}+'('+${#strings.arraySplit(rs.menuMsgDetail ?: '', '|')[msgStat.index]}+'ê°œ)'"></span>
														</div>
													</th:block>
												</th:block>
											</th:block>
											<th:block th:if="${rs.orderSet == '2000' || rs.orderSet == '3000'}">
												<th:block th:each="msg,msgStat : ${#strings.setSplit(rs.menuMsg,'|')}">
													<th:block th:if="${#strings.substring(msg,0,1) == '!'}">
														<span class="text-red-600 text-sm" th:text="${#strings.substring(msg,1)}"></span>
													</th:block>
													<th:block th:if="${#strings.substring(msg,0,1) != '!'}">
														<span class="text-sm" th:text="${msg}"></span>
													</th:block>
												</th:block>
											</th:block>
										</div>
										<div class="flex items-center justify-between mt-4">
											<div th:if="${rs.deliveryStatus == '0000'}" class="status-indicator bg-green-100 text-blue-800 px-4 py-2 rounded-full text-sm font-semibold flex items-center">
												<i class="fas fa-clock mr-2"></i>
												<span>ë°°ì†¡ì™„ë£Œ</span>
											</div>
											<div th:if="${rs.deliveryStatus == '1000'}" class="status-indicator bg-yellow-100 text-yellow-800 px-4 py-2 rounded-full text-sm font-semibold flex items-center">
												<i class="fas fa-clock mr-2"></i>
												<span>ë°°ì†¡ì „</span>
											</div>
											<div class="text-right">
												<div class="text-lg font-bold text-gray-800" th:text="${#numbers.formatInteger(rs.payAmt,3,'COMMA')} + 'ì›'"></div>
												<div class="text-sm text-gray-500" th:text="'ìˆ˜ëŸ‰: '+${rs.orderQty} + 'ê°œ'"></div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</th:block>
					</div>
			
					<!-- ë°›ëŠ”ë¶„ ì •ë³´ ì¹´ë“œ -->
					<div class="bg-white rounded-2xl card-shadow p-6 mb-8">
						<h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
							<i class="fas fas fa-user-tag mr-3 text-blue-500"></i>
							ë°›ëŠ”ë¶„ ì •ë³´
						</h3>
						
						<div class="space-y-4">
							<div class="flex justify-between items-center py-2">
								<span class="text-gray-600">ì´ë¦„</span>
								<span class="font-semibold" th:text="${order.receiveName}"></span>
							</div>
							<div class="flex justify-between items-center py-2">
								<span class="text-gray-600">í•¸ë“œí°</span>
								<span class="font-semibold" th:text="${receivePhone}"></span>
							</div>
							<div class="flex flex-col sm:flex-row sm:justify-between sm:items-center py-2 space-y-1 sm:space-y-0">
								<span class="text-gray-600 flex items-center">
									ì£¼ì†Œ
								</span>
								<span class="font-semibold break-words whitespace-normal w-full sm:w-auto" th:text="${order.receivePostNum} + ') ' + ${order.receiveAddr} + ' ' + ${order.receiveAddrDetail}"></span>
							</div>
							<div class="flex justify-between items-center py-2">
								<span class="text-gray-600 flex items-center">
									ë°°ì†¡ ìœ í˜•
								</span>
								<span class="font-semibold" th:if="${order.delivKind == '1000'}">ë‹¹ì¼ë°°ì†¡(ì•ˆì‚°)</span>
								<span class="font-semibold" th:if="${order.delivKind == '2000'}">ìš°ì²´êµ­ íƒë°°(ì•ˆì‚° ì™¸)</span>
							</div>
							<div class="flex flex-col sm:flex-row sm:justify-between sm:items-center py-2 space-y-1 sm:space-y-0">
								<span class="text-gray-600 flex items-center">
									ê³µë™í˜„ê´€ ë¹„ë°€ë²ˆí˜¸
								</span>
								<span class="font-semibold break-words whitespace-normal w-full sm:w-auto" th:text="${order.commonPwd}"></span>
							</div>
							<div class="flex flex-col sm:flex-row sm:justify-between sm:items-center py-2 space-y-1 sm:space-y-0">
								<span class="text-gray-600 flex items-center">
									ì „í•˜ì‹¤ë§ì”€
								</span>
								<span class="font-semibold break-words whitespace-normal w-full sm:w-auto" th:text="${order.bigo}"></span>
							</div>
						</div>
					</div>
			
					<!-- ê²°ì œ ì •ë³´ ì¹´ë“œ -->
					<div class="bg-white rounded-2xl card-shadow p-6 mb-8">
						<h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
							<i class="fas fa-credit-card mr-3 text-blue-500"></i>
							ê²°ì œ ì •ë³´
						</h3>
						
						<div class="space-y-4">
							<div class="flex justify-between items-center py-2">
								<span class="text-gray-600 flex items-center">
									<i class="fas fa-money-bill mr-2 text-green-500"></i>
									ìƒí’ˆê¸ˆì•¡
								</span>
								<span class="font-semibold" th:text="${#numbers.formatInteger(order.totalProductAmt,3,'COMMA')} +'ì›'"></span>
							</div>
							<div th:if="${order.delivKind != '2000' && order.totalDelyAmt > 0}" class="flex justify-between items-center py-2">
								<span class="text-gray-600 flex items-center">
									<i class="fas fa-truck mr-2 text-green-500"></i>
									ë°°ì†¡ë¹„
								</span>
								<span class="font-semibold" th:text="${#numbers.formatInteger(order.totalDelyAmt,3,'COMMA')} +'ì›'"></span>
							</div>
							<div th:if="${order.delivKind == '2000'}" class="flex justify-between items-center py-2">
								<span class="text-gray-600 flex items-center">
									<i class="fas fa-truck mr-2 text-green-500"></i>
									ìš°ì²´êµ­íƒë°°
								</span>
								<span class="font-semibold">4,000ì›</span>
							</div>
							<div th:if="${order.packaging == '1000'}" class="flex justify-between items-center py-2">
								<span class="text-gray-600 flex items-center">
									<i class="fas fa-snowflake mr-2 text-blue-500"></i>
									ë³´ëƒ‰ê°€ë°©(ì‹ ê·œ) ë³´ì¦ê¸ˆ
								</span>
								<span class="font-semibold">5,000ì›</span>
							</div>
							<hr class="border-gray-200">
							<div class="flex justify-between items-center py-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg px-4">
								<span class="text-lg font-bold text-gray-800">ì´ ì£¼ë¬¸ ê¸ˆì•¡</span>
								<span class="text-2xl font-bold text-blue-600" th:text="${#numbers.formatInteger(order.totalAmount,3,'COMMA')} +'ì›'"></span>
							</div>
						</div>
					</div>
					<!-- í™˜ë¶ˆ ì •ë³´ ì¹´ë“œ -->
					<div th:if="${refund != null}" class="bg-white rounded-2xl card-shadow p-6 mb-8">
						<h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
							<i class="fas fa-undo mr-3 text-blue-500"></i>
							í™˜ë¶ˆ ì‹ ì²­ ì •ë³´
						</h3>
						
						<div class="space-y-4">
							<div class="flex justify-between items-center py-2">
								<span class="text-gray-600">í™˜ë¶ˆ ì‚¬ìœ </span>
								<span class="font-semibold" th:text="${refund.refundMsg}"></span>
							</div>
							<div class="flex justify-between items-center py-2">
								<span class="text-gray-600">í™˜ë¶ˆ ì§„í–‰ ìƒíƒœ</span>
								<span class="font-semibold" th:switch="${refund.status}">
									<span th:case="'0000'" th:text="'ì‹ ì²­'"></span>
									<span th:case="'1001'" th:text="'ë°˜ë ¤'"></span>
									<span th:case="'2001'" th:text="'í™˜ë¶ˆ ì™„ë£Œ'"></span>
									<span th:case="*" th:text="${refund.status}"></span>
								</span>
							</div>
							<div th:if="${refund.status == '1001' && !#strings.isEmpty(refund.refundAnswer)}" class="flex justify-between items-center py-2">
								<span class="text-gray-600">ë°˜ë ¤ ë‚´ìš©</span>
								<span class="font-semibold" th:text="${refund.refundAnswer}"></span>
							</div>
						</div>
					</div>
					<!-- ì£¼ë¬¸ ìƒíƒœê°€ '0000'ì´ê³  ê²°ì œì¼ì´ ë‹¹ì¼ì´ë©°, ì°¨ë‹¨ ì¡°ê±´ì— í•´ë‹¹í•˜ì§€ ì•ŠëŠ” ê²½ìš° - ì£¼ë¬¸ ì·¨ì†Œ -->
					<div class="flex flex-col md:flex-row gap-4 justify-center" th:if="${refund == null and order.orderStatus == '0000' and #strings.substring(order.orderPayDt, 0, 10) == #dates.format(#dates.createNow(), 'yyyy-MM-dd')}">
						<button type="button" onclick="fnPayCancel()" class="border-2 border-red-300 text-red-600 px-8 py-3 rounded-full font-semibold hover:border-red-400 hover:bg-red-50 transition-all duration-300 flex items-center justify-center">
							<i class="fas fa-times mr-2"></i>
							ì£¼ë¬¸ ì·¨ì†Œ
						</button>
					</div>
					<!-- ì£¼ë¬¸ ìƒíƒœê°€ '0000'ì´ê³  ê²°ì œì¼ì´ ë‹¹ì¼ì„ ì§€ë‚¬ìœ¼ë©°, ì°¨ë‹¨ ì¡°ê±´ì— í•´ë‹¹í•˜ì§€ ì•ŠëŠ” ê²½ìš° - í™˜ë¶ˆ ì‹ ì²­ -->
					<div class="flex flex-col md:flex-row gap-4 justify-center" th:if="${refund == null and order.orderStatus == '0000' and #strings.substring(order.orderPayDt, 0, 10) < #dates.format(#dates.createNow(), 'yyyy-MM-dd')}">
						<button type="button" onclick="fnRefundRequest()" id="refundBtn" class="border-2 border-red-300 text-red-600 px-8 py-3 rounded-full font-semibold hover:border-red-400 hover:bg-red-50 transition-all duration-300 flex items-center justify-center">
							<i class="fas fa-times mr-2"></i>
							í™˜ë¶ˆ ì‹ ì²­
						</button>
					</div>
				</th:block>
				<th:block th:if="${order == null or #lists.isEmpty(order)}">
					<div class="bg-white rounded-2xl card-shadow p-10 text-center">
						<div class="flex justify-center mb-4">
							<div class="w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center">
								<i class="fas fa-box-open text-2xl text-gray-400"></i>
							</div>
						</div>
						<h3 class="text-lg font-semibold text-gray-700 mb-2">
							ì•„ì§ ì£¼ë¬¸ ë‚´ì—­ì´ ì—†ì–´ìš”
						</h3>
						<p class="text-sm text-gray-500 mb-6">
							ë°˜ì°¬ì´ ìƒê°ë‚  ë•Œ ì–¸ì œë“ ì§€ ì£¼ë¬¸í•´ ì£¼ì„¸ìš” ğŸ˜Š
						</p>
						<a href="/order"
						   class="inline-flex items-center px-6 py-3 bg-green-600 text-white text-sm font-semibold rounded-full hover:bg-green-700 transition">
							ë©”ë‰´ ë³´ëŸ¬ê°€ê¸°
						</a>
					</div>
				</th:block>
			</th:block>
			<div id="modalRefund" class="modal-overlay fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 opacity-0 pointer-events-none hidden">
				<div class="modal-content bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 transform scale-90">
					<div class="p-6">
						<div class="flex justify-between items-center mb-6">
							<h2 class="text-xl font-bold text-gray-800">í™˜ë¶ˆ ì‹ ì²­</h2>
							<button type="button" onclick="closeModal('modalRefund')" class="text-gray-400 hover:text-gray-600 transition duration-200">
								<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
								</svg>
							</button>
						</div>
						
						<div class="space-y-4">
							<div>
								<label class="block text-sm font-medium text-gray-700 mb-1">í™˜ë¶ˆì‚¬ìœ </label>
								<input type="text" id="refundMsg"
									   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
									   placeholder="ë©”ì„¸ì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”.">
							</div>
						</div>
						
						<div class="flex justify-end space-x-3 mt-6">
							<button type="button" onclick="submitForm()" 
									class="px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition duration-200">
								ì‹ ì²­
							</button>
							<button type="button" onclick="closeModal('modalRefund')" 
									class="px-4 py-2 text-gray-600 hover:text-gray-800 transition duration-200">
								ì·¨ì†Œ
							</button>
						</div>
					</div>
				</div>
			</div>
			<script th:inline="javascript">
				//ê²°ì œ ì·¨ì†Œ
				function fnPayCancel(){
					
					let check = fnCommonBlock();
					if (check) {
						alert("ìµì¼ ë°°ì†¡ ë¬¼ëŸ‰ ì¤€ë¹„ í™•ì •ìœ¼ë¡œ ì¸í•´ ìµì¼ ë°°ì†¡ê±´ ê²°ì œì— ëŒ€í•´ì„œëŠ”\nì˜¤í›„ 4ì‹œ ì´í›„ë¡œëŠ” ì£¼ë¬¸ ì·¨ì†Œê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. \nì–‘í•´ ë¶€íƒë“œë¦½ë‹ˆë‹¤. ë¶€ë“ì´í•œ ì‚¬ì •ì˜ ê²½ìš°,\nâ€˜ì¹´ì¹´ì˜¤í†¡ ì±„ë„â€™ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.");
						return;
					}
					if(!confirm("ì£¼ë¬¸ ì·¨ì†Œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
					let orderNo = /*[[${order.orderNo}]]*/ "";
					if(orderNo == ""){
						alert("ì ì‹œ í›„ì— ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
						return;
					}
					let formData = {
						orderNo : orderNo
					}
					$.showMask();
					$.ajax({
						url : "/rest/order/payCancelAjax",
						type : "POST",
						dataType : "json",
						data : formData,
						success : function(result) {
							$.hideMask();
							if(result.data.code){
								alert(result.data.message)	
							} else {
								alert('ê²°ì œ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.')
								location.reload();
							}
						}, error : function(request, status, error) {
							$.hideMask();
							alert("ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•´ ì£¼ì„¸ìš”.");
						}
					});
				}
				
				//í™˜ë¶ˆìš”ì²­
				function fnRefundRequest(){
					let check = fnCommonBlock();
					if (check) {
						alert("ìµì¼ ë°°ì†¡ ë¬¼ëŸ‰ ì¤€ë¹„ í™•ì •ìœ¼ë¡œ ì¸í•´ ìµì¼ ë°°ì†¡ê±´ ê²°ì œì— ëŒ€í•´ì„œëŠ”\nì˜¤í›„ 4ì‹œ ì´í›„ë¡œëŠ” ì£¼ë¬¸ ì·¨ì†Œê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. \nì–‘í•´ ë¶€íƒë“œë¦½ë‹ˆë‹¤. ë¶€ë“ì´í•œ ì‚¬ì •ì˜ ê²½ìš°,\nâ€˜ì¹´ì¹´ì˜¤í†¡ ì±„ë„â€™ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.");
						return;
					} else {
						//í™˜ë¶ˆìš”ì²­ë¡œì§
						openModal("modalRefund");
					}
				}
				
				//ìƒí’ˆ ì¤‘ì— í˜„ì¬ ì‹œê°„ ê¸°ì¤€ ë‚´ì¼ ë‚ ì§œì¸ ìƒí’ˆì´ ìˆëŠ”ì§€ ì²´í¬(ì „ë‚  ì˜¤í›„ 4ì‹œ ì´ì „ê¹Œì§€ë§Œ ì·¨ì†Œê°€ëŠ¥)
				function fnCommonBlock(){
					let productList = /*[[${order.productList}]]*/ "";
					
					// í˜„ì¬ ì‹œê°„
					const now = new Date();
					const currentHour = now.getHours();
	
					// ë‚´ì¼ ë‚ ì§œë¥¼ YYYYMMDD í˜•ì‹ìœ¼ë¡œ êµ¬í•˜ê¸°
					const tomorrow = new Date();
					tomorrow.setDate(tomorrow.getDate() + 1);
					const tomorrowStr = tomorrow.getFullYear().toString() + 
										(tomorrow.getMonth() + 1).toString().padStart(2, '0') + 
										tomorrow.getDate().toString().padStart(2, '0');
										
					//console.log('ë‚´ì¼ ë‚ ì§œ:', tomorrowStr);
					//console.log('í˜„ì¬ ì‹œê°„:', currentHour + 'ì‹œ');
					
					// ë‚´ì¼ ë°°ì†¡ ìƒí’ˆì´ ìˆëŠ”ì§€ ì²´í¬
					const hasTomorrowItems = productList.some(item => item.menuDay === tomorrowStr);
					
					// ì˜¤í›„ 4ì‹œ(16ì‹œ) ì´í›„ì¸ì§€ ì²´í¬
					const isAfter4PM = currentHour >= 16;
					
					// ë‚´ì¼ ë°°ì†¡ ìƒí’ˆì´ ìˆê³  ì˜¤í›„ 4ì‹œ ì´í›„ë¼ë©´ true ë°˜í™˜
					return hasTomorrowItems && isAfter4PM;
				}
				
				//ìƒí’ˆ ì¤‘ì— ë‚´ì¼ ê¸°ì¤€ ì§€ë‚œ ìƒí’ˆì´ ìˆëŠ”ì§€ ì²´í¬
				function fnBtnCheck(){
					let productList = /*[[${order.productList}]]*/ "";
					
					// í˜„ì¬ ì‹œê°„
					const now = new Date();
					const currentHour = now.getHours();
	
					// ë‚´ì¼ ë‚ ì§œë¥¼ YYYYMMDD í˜•ì‹ìœ¼ë¡œ êµ¬í•˜ê¸°
					const tomorrow = new Date();
					tomorrow.setDate(tomorrow.getDate() + 1);
					const tomorrowStr = tomorrow.getFullYear().toString() + 
										(tomorrow.getMonth() + 1).toString().padStart(2, '0') + 
										tomorrow.getDate().toString().padStart(2, '0');
										
					//console.log('ë‚´ì¼ ë‚ ì§œ:', tomorrowStr);
					//console.log('í˜„ì¬ ì‹œê°„:', currentHour + 'ì‹œ');
					
					const hasTomorrowItems = productList.some(item => item.menuDay < tomorrowStr);
					
					if(hasTomorrowItems)$("#refundBtn").hide();
					
				}
				
				function openModal(modalId) {
					const modal = document.getElementById(modalId);
					modal.classList.remove('hidden', 'opacity-0', 'pointer-events-none');
		        }
		
		        function closeModal(modalId) {
		            const modal = document.getElementById(modalId);
		            modal.classList.add('opacity-0', 'pointer-events-none');
		            setTimeout(() => modal.classList.add('hidden'), 300);
		        }
		        
		        function submitForm() {
					let refundMsg = $("#refundMsg").val();
					if(refundMsg == ""){
						alert("í™˜ë¶ˆì‚¬ìœ ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
						return;
					}
					let orderNo = /*[[${order.orderNo}]]*/ "";
					let formData = {
						orderNo : orderNo,
						refundMsg : refundMsg
					}
					$.showMask();
					$.ajax({
						url : "/rest/order/refundAjax",
						type : "POST",
						dataType : "json",
						data : formData,
						success : function(result) {
							$.hideMask();
							alert(result.data.message);
							if(result.data.code == "0000"){
								closeModal('modalRefund');
								location.reload();
							}
						}, error : function(request, status, error) {
							$.hideMask();
							alert("ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•´ ì£¼ì„¸ìš”.");
						}
					});
				}
				
				fnBtnCheck();
			</script>
		</main>
</html>