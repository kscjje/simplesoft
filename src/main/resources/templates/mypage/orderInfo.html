<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
		xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
		layout:decorate="~{layouts/mypage_layout}">
		<main class="" layout:fragment="content" style="padding: 10px;">
			<style>
				body {
					font-family: 'Noto Sans KR', sans-serif;
				}
				.gradient-bg {
					background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				}
				.card-shadow {
					box-shadow: 0 10px 25px rgba(0,0,0,0.1);
				}
				.status-indicator {
					position: relative;
					overflow: hidden;
				}
				.status-indicator::before {
					content: '';
					position: absolute;
					top: 0;
					left: -100%;
					width: 100%;
					height: 100%;
					background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
					animation: shimmer 2s infinite;
				}
				@keyframes shimmer {
					0% { left: -100%; }
					100% { left: 100%; }
				}
				.product-item {
					transition: all 0.3s ease;
				}
				.product-item:hover {
					transform: translateY(-2px);
					box-shadow: 0 5px 15px rgba(0,0,0,0.1);
				}
			</style>
			<!-- Main Content -->
			<div class="container mx-auto px-4">
				<!-- 주문 정보 카드 -->
				<div class="bg-white rounded-2xl card-shadow p-6 mb-8">
					<div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
						<div class="flex-1">
							<div class="flex items-center justify-between mb-2">
								<h2 class="text-2xl font-bold text-gray-800">주문 내역</h2>
							</div>
						</div>
					</div>
					<th:block th:each="rs,rsStat : ${order}">
						<th:block th:each="p, pStat : ${rs.productList}">
							<div class="space-y-4">
								<div class="product-item bg-gray-50 rounded-lg p-4">
									<div class="items-center justify-between">
										<h4 class="font-semibold text-gray-800 mb-2 text-sm">
											<span th:text="${p.menuDay.substring(0,4)} + '.' + ${p.menuDay.substring(4,6)} + '.' + ${p.menuDay.substring(6,8)}"></span>
											<span class="text-right inline-block float-right">
												<th:block th:if="${p.orderSet == '1000'}"> 일반세트(추가)</th:block>
												<th:block th:if="${p.orderSet == '2000'}"> 1인분세트</th:block>
												<th:block th:if="${p.orderSet == '3000'}"> 일반세트</th:block>
												<th:block th:if="${p.delivTime == '1000'}"> 오전배달</th:block>
												<th:block th:if="${p.delivTime == '2000'}"> 오후배달</th:block>
											</span>
										</h4>
										<div th:class="${p.orderSet == '1000'} ? 'md:grid md:grid-cols-3 md:gap-2 text-m text-gray-600' : 'grid grid-cols-2 md:grid-cols-3 gap-2 text-m text-gray-600'">
											<th:block th:if="${p.orderSet == '1000'}">
												<th:block th:each="msg,msgStat : ${#strings.setSplit(p.menuMsg,'|')}">
													<th:block th:if="${#strings.substring(msg,0,1) == '!'}">
														<div class="block md:inline">
															<span class="text-red-600 text-sm" th:text="${#strings.substring(msg,1)}"></span>
															<span class="text-red-600 text-sm" th:text="'('+${#strings.arraySplit(p.menuMsgDetail ?: '', '|')[msgStat.index]}+'개)'"></span>
														</div>
													</th:block>
													<th:block th:if="${#strings.substring(msg,0,1) != '!'}">
														<div class="block md:inline">
															<span class="text-sm" th:text="${msg}+'('+${#strings.arraySplit(p.menuMsgDetail ?: '', '|')[msgStat.index]}+'개)'"></span>
														</div>
													</th:block>
												</th:block>
											</th:block>
											<th:block th:if="${p.orderSet == '2000' || p.orderSet == '3000'}">
												<th:block th:each="msg,msgStat : ${#strings.setSplit(p.menuMsg,'|')}">
													<th:block th:if="${#strings.substring(msg,0,1) == '!'}">
														<span class="text-red-600 text-sm" th:text="${#strings.substring(msg,1)}"></span>
													</th:block>
													<th:block th:if="${#strings.substring(msg,0,1) != '!'}">
														<span class="text-sm" th:text="${msg}"></span>
													</th:block>
												</th:block>
											</th:block>
											
											<div class="flex items-center justify-between mt-4">
												<div th:if="${p.deliveryStatus == '0000'}" class="status-indicator bg-green-100 text-blue-800 px-4 py-2 rounded-full text-sm font-semibold flex items-center">
													<i class="fas fa-clock mr-2"></i>
													<span>배송완료</span>
												</div>
												<div th:if="${p.deliveryStatus == '1000'}" class="status-indicator bg-yellow-100 text-yellow-800 px-4 py-2 rounded-full text-sm font-semibold flex items-center">
													<i class="fas fa-clock mr-2"></i>
													<span>배송전</span>
												</div>
												<div class="text-right">
													<div class="text-lg font-bold text-gray-800" th:text="${#numbers.formatInteger(p.payAmt,3,'COMMA')} + '원'"></div>
													<div class="text-sm text-gray-500" th:text="'수량: '+${rs.orderQty} + '개'"></div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</th:block>
					</th:block>
				</div>
			</div>
			<script th:inline="javascript">
			</script>
		</main>
</html>