<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
		xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
		layout:decorate="~{layouts/mypage_layout}">
		<main class="content-wrapper flex items-center justify-center p-6" layout:fragment="content" style="padding: 10px;">
			<style>
				.gradient-bg {
					background: linear-gradient(135deg, #fff5f0 0%, #ffeee6 50%, #fff9f5 100%);
				}
				.form-input {
					transition: all 0.3s ease;
				}
				.form-input:focus {
					border-color: #ff6b35;
					box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
				}
				.password-strength {
					height: 4px;
					border-radius: 2px;
					transition: all 0.3s ease;
				}
				.strength-weak { background-color: #ef4444; width: 33%; }
				.strength-medium { background-color: #f59e0b; width: 66%; }
				.strength-strong { background-color: #10b981; width: 100%; }
			</style>
			<!-- Main Content -->
			<div class="bg-white rounded-lg shadow-lg p-8">
				<div class="text-center mb-8">
					<h2 class="text-3xl font-bold text-gray-900 mb-2">íšŒì›ê°€ì…</h2>
					<p class="text-gray-600">ë°¥ìˆ˜ë‹ˆ ë°˜ì°¬ê³¼ í•¨ê»˜ í–‰ë³µí•œ ì‹ì‚¬</p>
				</div>
	
				<form id="memberForm" class="space-y-6" onsubmit="memberSave(); return false;">
					<!-- ì•„ì´ë”” -->
					<div>
						<label for="userId" class="block text-sm font-medium text-gray-700 mb-2">
							<i class="fas fa-user mr-2 text-blue-500"></i>ì•„ì´ë”” <font color="red">* </font>
						</label>
						<div class="flex space-x-2">
							<input type="text" id="userId" name="userId" 
								   class="w-44 form-input px-3 py-2 border border-gray-300 rounded-md focus:outline-none"
								   onkeypress="enterKey()"
								   oninput="resetIdCheck()"
								   maxlength="20"
								   placeholder="ì˜ë¬¸, ìˆ«ì ì¡°í•© 6-20ì">
							<button type="button" onclick="idCheck()" class="text-sm px-4 py-2 bg-gray-700 text-white rounded-md transition-colors">
								ì¤‘ë³µí™•ì¸
							</button>
						</div>
						<p id="userIdMessage" class="text-sm mt-1"></p>
					</div>
	
					<!-- ë¹„ë°€ë²ˆí˜¸ -->
					<div>
						<label for="userPw" class="block text-sm font-medium text-gray-700 mb-2">
							<i class="fas fa-lock mr-2 text-blue-500"></i>ë¹„ë°€ë²ˆí˜¸ <font color="red">* </font>
						</label>
						<input type="password" id="userPw" name="userPw"
								class="w-full form-input px-3 py-2 border border-gray-300 rounded-md focus:outline-none"
								maxlength="20"
								oninput="checkPasswordStrength()"
								placeholder="ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì ì¡°í•© 8-20ì">
						<p id="passwordMessage" class="text-sm mt-1"></p>
						<div class="mt-2">
							<div class="flex justify-between text-xs text-gray-500 mb-1">
								<span>ë¹„ë°€ë²ˆí˜¸ ê°•ë„</span>
								<span id="passwordStrengthText">-</span>
							</div>
							<div class="w-full bg-gray-200 rounded-full h-1">
								<div id="passwordStrengthBar" class="password-strength bg-gray-200"></div>
							</div>
						</div>
					</div>
	
					<!-- ë¹„ë°€ë²ˆí˜¸ í™•ì¸ -->
					<div>
						<label for="passwordConfirm" class="block text-sm font-medium text-gray-700 mb-2">
							<i class="fas fa-lock mr-2 text-blue-500"></i>ë¹„ë°€ë²ˆí˜¸ í™•ì¸ <font color="red">* </font>
						</label>
						<input type="password" id="passwordConfirm" name="passwordConfirm"
								maxlength="20"
								class="w-full form-input px-3 py-2 border border-gray-300 rounded-md focus:outline-none"
								oninput="passConfirmInput()"
								placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•´ ì£¼ì„¸ìš”.">
						<p id="passwordConfirmMessage" class="text-sm mt-1"></p>
					</div>
	
					<!-- ì´ë¦„ -->
					<div>
						<label for="userNm" class="block text-sm font-medium text-gray-700 mb-2">
							<i class="fas fa-signature mr-2 text-blue-500"></i>ì´ë¦„ <font color="red">* </font>
						</label>
						<input type="text" id="userNm" name="userNm"
								class="w-full form-input px-3 py-2 border border-gray-300 rounded-md focus:outline-none"
								maxlength="20"
								placeholder="ì‹¤ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”">
					</div>
					<!-- í•¸ë“œí° ë²ˆí˜¸ -->
					<div>
						<label for="userMobile" class="block text-sm font-medium text-gray-700 mb-2">
							<i class="fas fa-mobile-alt mr-2 text-blue-500"></i>í•¸ë“œí° <font color="red">* </font>
						</label>
						<div class="flex space-x-2">
							<input type="text" id="userMobile" name="userMobile" class="phoneNumber flex-1 form-input px-3 py-2 border border-gray-300 rounded-md focus:outline-none" placeholder="010-1234-5678" maxlength="20">
						</div>
					</div>
	
					<!-- ì´ë©”ì¼ -->
					<div>
						<label for="email" class="block text-sm font-medium text-gray-700 mb-2">
							<i class="fas fa-envelope mr-2 text-blue-500"></i>ì´ë©”ì¼ <font color="red">* </font>
						</label>
						<div class="flex flex-wrap items-center gap-2">
							<input type="text" id="o_email" maxlength="30" class="flex-1 form-input px-3 py-2 border border-gray-300 rounded-md focus:outline-none" placeholder="example@email.com">
							<span class="mt-1">@</span>
							<input type="text" id="o_email2" maxlength="30" class="flex-1 form-input px-3 py-2 border border-gray-300 rounded-md focus:outline-none" placeholder="ì´ë©”ì¼ ë„ë©”ì¸" onkeypress="enterKey2()">
							<select name="emailSelect" class="border border-gray-300 rounded px-3 py-2 w-full bg-white" onchange="res(this.value)">
								<option value="">ì§ì ‘ì…ë ¥</option>
								<option value="naver.com">naver.com</option>
								<option value="daum.net">daum.net</option>
								<option value="hanmail.net">hanmail.net</option>
								<option value="nate.com">nate.com</option>
								<option value="gmail.com">gmail.com</option>
							</select>
							<input type="text" id="od_email" name="userEmail" maxlength="20" class="hidden">
						</div>
					</div>
	
					<!-- ì£¼ì†Œ -->
					<div>
						<label class="block text-sm font-medium text-gray-700 mb-2">
							<i class="fas fa-map-marker-alt mr-2 text-blue-500"></i>ì£¼ì†Œ <font color="red">* </font>
						</label>
						<div class="flex gap-2 mb-2">
						<input type="text" id="o_postNum" name="zipcode" readonly
								class="w-32 form-input px-3 py-2 border border-gray-300 rounded-md focus:outline-none bg-gray-50"
								placeholder="ìš°í¸ë²ˆí˜¸">
							<button type="button" id="searchAddress"
									class="px-4 py-2 bg-gray-700 text-white rounded-md transition-colors"
									onclick="execDaumPostcode()"> 
								ì£¼ì†Œ ê²€ìƒ‰
							</button>
						</div>
						<!-- ì£¼ì†Œ ê²€ìƒ‰ ê²°ê³¼ iframe -->
						<div id="wrap1" class="w-full border border-gray-300 rounded-md mb-2" style="display: none; height: 300px; position: relative;">
							<img src="//t1.daumcdn.net/postcode/resource/images/close.png" id="btnFoldWrap" alt="ì ‘ê¸° ë²„íŠ¼" class="absolute top-0 right-0 cursor-pointer z-10" onclick="foldDaumPostcode()">
						</div>
						<input type="text" id="o_addr" name="address" readonly
							   class="w-full form-input px-3 py-2 border border-gray-300 rounded-md focus:outline-none bg-gray-50"
							   placeholder="ê¸°ë³¸ì£¼ì†Œ">
						<input type="text" id="o_addrDetail" name="addressDetail"
							   class="w-full form-input px-3 py-2 border border-gray-300 rounded-md focus:outline-none"
							   placeholder="ìƒì„¸ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”">
					</div>
					
					<div>
						<label for="commonPwd" class="block text-sm font-medium text-gray-700 mb-2">ê³µë™í˜„ê´€ ë¹„ë°€ë²ˆí˜¸</label>
						<input type="text" id="commonPwd" name="commonPwd" class="w-full px-3 py-2 border border-gray-300 rounded-md input-focus" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ì˜ˆì‹œ: ì¢…ë²„íŠ¼ + 1234" maxlength="50">
					</div>
					<div>
						<label for="bigo" class="block text-sm font-medium text-gray-700 mb-2">ì „í•˜ì‹¤ ë§ì”€</label>
						<textarea id="bigo" name="bigo" class="w-full px-3 py-2 border border-gray-300 rounded-md input-focus" maxlength="300" rows="3" style="resize: none;" placeholder="ë°°ì†¡ ì‹œì— ì°¾ê¸° ì–´ë ¤ìš´ ê³³ì´ë‚˜ ê¸°íƒ€ ì‚¬í•­ì´ ìˆëŠ” ê²½ìš° ì›í™œí•œ ë°°ì†¡ì„ ìœ„í•´ ê¸°ì…í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤ :)"></textarea>
					</div>
					<!-- ì œì¶œ ë²„íŠ¼ -->
					<div class="pt-6">
						<button type="button" id="submitBtn"
								class="w-full py-3 px-4 bg-gray-700 text-white font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2"
								onclick="memberSave()">
							<i class="fas fa-user-plus mr-2"></i>íšŒì›ê°€ì… ì™„ë£Œ
						</button>
					</div>
				</form>
	
				<div class="text-center mt-6">
					<p class="text-sm text-gray-600">
						ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? 
						<a href="/login" class="hover:underline font-medium">ë¡œê·¸ì¸</a>
					</p>
				</div>
			</div>
			<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
			<script>
				
				// ìš°í¸ë²ˆí˜¸ ì°¾ê¸° ì°¾ê¸° í™”ë©´ì„ ë„£ì„ element
				var element_wrap = document.getElementById('wrap1');
				
				function foldDaumPostcode() {
					// iframeì„ ë„£ì€ elementë¥¼ ì•ˆë³´ì´ê²Œ í•œë‹¤.
					element_wrap.style.display = 'none';
				}
				function foldDaumPostcode2() {
					// iframeì„ ë„£ì€ elementë¥¼ ì•ˆë³´ì´ê²Œ í•œë‹¤.
					element_wrap.style.display = 'none';
				}
				
			 	// ìš°í¸ë²ˆí˜¸ ì°¾ê¸°
				function execDaumPostcode(){
					if(typeof daum === 'undefined'){
						alert("ë‹¤ìŒ ìš°í¸ë²ˆí˜¸ postcode.v2.js íŒŒì¼ì´ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
						return false;
					}
					// í˜„ì¬ scroll ìœ„ì¹˜ë¥¼ ì €ì¥í•´ë†“ëŠ”ë‹¤.
					var currentScroll = Math.max(document.body.scrollTop, document.documentElement.scrollTop);
					new daum.Postcode({
						oncomplete: function(data) {
							// ê²€ìƒ‰ê²°ê³¼ í•­ëª©ì„ í´ë¦­í–ˆì„ë•Œ ì‹¤í–‰í•  ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ë¶€ë¶„.
	
							// ê° ì£¼ì†Œì˜ ë…¸ì¶œ ê·œì¹™ì— ë”°ë¼ ì£¼ì†Œë¥¼ ì¡°í•©í•œë‹¤.
							// ë‚´ë ¤ì˜¤ëŠ” ë³€ìˆ˜ê°€ ê°’ì´ ì—†ëŠ” ê²½ìš°ì—” ê³µë°±('')ê°’ì„ ê°€ì§€ë¯€ë¡œ, ì´ë¥¼ ì°¸ê³ í•˜ì—¬ ë¶„ê¸° í•œë‹¤.
							var addr = ''; // ì£¼ì†Œ ë³€ìˆ˜
							var extraAddr = ''; // ì°¸ê³ í•­ëª© ë³€ìˆ˜
	
							//ì‚¬ìš©ìê°€ ì„ íƒí•œ ì£¼ì†Œ íƒ€ì…ì— ë”°ë¼ í•´ë‹¹ ì£¼ì†Œ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.
							if (data.userSelectedType === 'R') { // ì‚¬ìš©ìê°€ ë„ë¡œëª… ì£¼ì†Œë¥¼ ì„ íƒí–ˆì„ ê²½ìš°
								addr = data.roadAddress;
							} else { // ì‚¬ìš©ìê°€ ì§€ë²ˆ ì£¼ì†Œë¥¼ ì„ íƒí–ˆì„ ê²½ìš°(J)
								addr = data.jibunAddress;
							}
	
							// ì‚¬ìš©ìê°€ ì„ íƒí•œ ì£¼ì†Œê°€ ë„ë¡œëª… íƒ€ì…ì¼ë•Œ ì°¸ê³ í•­ëª©ì„ ì¡°í•©í•œë‹¤.
							if(data.userSelectedType === 'R'){
								// ë²•ì •ë™ëª…ì´ ìˆì„ ê²½ìš° ì¶”ê°€í•œë‹¤. (ë²•ì •ë¦¬ëŠ” ì œì™¸)
								// ë²•ì •ë™ì˜ ê²½ìš° ë§ˆì§€ë§‰ ë¬¸ìê°€ "ë™/ë¡œ/ê°€"ë¡œ ëë‚œë‹¤.
								if(data.bname !== '' && /[ë™|ë¡œ|ê°€]$/g.test(data.bname)){
									extraAddr += data.bname;
								}
								// ê±´ë¬¼ëª…ì´ ìˆê³ , ê³µë™ì£¼íƒì¼ ê²½ìš° ì¶”ê°€í•œë‹¤.
								if(data.buildingName !== '' && data.apartment === 'Y'){
									extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
								}
								// í‘œì‹œí•  ì°¸ê³ í•­ëª©ì´ ìˆì„ ê²½ìš°, ê´„í˜¸ê¹Œì§€ ì¶”ê°€í•œ ìµœì¢… ë¬¸ìì—´ì„ ë§Œë“ ë‹¤.
								if(extraAddr !== ''){
									extraAddr = ' (' + extraAddr + ')';
								}
								// ì¡°í•©ëœ ì°¸ê³ í•­ëª©ì„ í•´ë‹¹ í•„ë“œì— ë„£ëŠ”ë‹¤.
								// document.getElementById("sample3_extraAddress").value = extraAddr;
							
							} else {
								// document.getElementById("sample3_extraAddress").value = '';
							}
	
							// ìš°í¸ë²ˆí˜¸ì™€ ì£¼ì†Œ ì •ë³´ë¥¼ í•´ë‹¹ í•„ë“œì— ë„£ëŠ”ë‹¤.
							document.getElementById("o_postNum").value = data.zonecode;
							document.getElementById("o_addr").value = addr;
	
							// iframeì„ ë„£ì€ elementë¥¼ ì•ˆë³´ì´ê²Œ í•œë‹¤.
							// (autoClose:false ê¸°ëŠ¥ì„ ì´ìš©í•œë‹¤ë©´, ì•„ë˜ ì½”ë“œë¥¼ ì œê±°í•´ì•¼ í™”ë©´ì—ì„œ ì‚¬ë¼ì§€ì§€ ì•ŠëŠ”ë‹¤.)
							element_wrap.style.display = 'none';
	
							// ìš°í¸ë²ˆí˜¸ ì°¾ê¸° í™”ë©´ì´ ë³´ì´ê¸° ì´ì „ìœ¼ë¡œ scroll ìœ„ì¹˜ë¥¼ ë˜ëŒë¦°ë‹¤.
							document.body.scrollTop = currentScroll;
						},
						// ìš°í¸ë²ˆí˜¸ ì°¾ê¸° í™”ë©´ í¬ê¸°ê°€ ì¡°ì •ë˜ì—ˆì„ë•Œ ì‹¤í–‰í•  ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ë¶€ë¶„. iframeì„ ë„£ì€ elementì˜ ë†’ì´ê°’ì„ ì¡°ì •í•œë‹¤.
						onresize : function(size) {
							element_wrap.style.height = size.height+'px';
						},
						width : '100%',
						height : '100%'
					}).embed(element_wrap);
	
					// iframeì„ ë„£ì€ elementë¥¼ ë³´ì´ê²Œ í•œë‹¤.
					element_wrap.style.display = 'block';				
				}
				
				// ì „ì—­ ë³€ìˆ˜
				let idChecked = false;
				let lastCheckedId = ''; // ë§ˆì§€ë§‰ìœ¼ë¡œ ì²´í¬í•œ ì•„ì´ë”” ì €ì¥
				
				// ì•„ì´ë”” ì…ë ¥ê°’ ë³€ê²½ ì‹œ í˜¸ì¶œ
				function resetIdCheck() {
				    const currentId = document.getElementById('userId').value;
				    const messageEl = document.getElementById('userIdMessage');
				    
				    // ë§ˆì§€ë§‰ìœ¼ë¡œ ì²´í¬í•œ ì•„ì´ë””ì™€ ë‹¤ë¥´ë©´ ì´ˆê¸°í™”
				    if (currentId !== lastCheckedId) {
				        idChecked = false;
				        messageEl.textContent = '';
				        messageEl.className = 'text-sm mt-1';
				    }
				}
				// ì•„ì´ë”” ì¤‘ë³µí™•ì¸
				function idCheck(){
					const userIdEl = document.getElementById('userId');
					const messageEl = document.getElementById('userIdMessage');
					const userId = userIdEl.value.trim();
					
					if (!userId) {
						messageEl.textContent = 'ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
						messageEl.className = 'text-sm mt-1 text-red-500';
						return;
					}
		
					const idPattern = /^[a-zA-Z0-9]{6,20}$/;
   					if (!idPattern.test(userId)) {
						messageEl.textContent = 'ì˜ë¬¸, ìˆ«ì ì¡°í•© 6-20ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.';
						messageEl.className = 'text-sm mt-1 text-red-500';
						return;
					}
					
					$.ajax({
					    url: "/rest/member/idCheck",
					    type: "POST",
					    dataType: "json",
					    data: {
					        userId: userId
					    },
					    success: function(result) {
					        if (result.responseCode === "SUCCESS") {
					            const totCnt = result.data?.id?.totCnt ?? -1;
					            if (totCnt === 0) {
					                messageEl.textContent = 'ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ì´ë””ì…ë‹ˆë‹¤.';
					                messageEl.className = 'text-sm mt-1 text-green-500';
					                idChecked = true;
					            } else if (totCnt > 0) {
					                messageEl.textContent = 'ì´ë¯¸ ì‚¬ìš©ì¤‘ì¸ ì•„ì´ë””ì…ë‹ˆë‹¤.';
					                messageEl.className = 'text-sm mt-1 text-red-500';
					                idChecked = false;
					                lastCheckedId = '';
					            } else {
					                messageEl.textContent = 'ì•„ì´ë”” í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
					                messageEl.className = 'text-sm mt-1 text-red-500';
					                idChecked = false;
					                lastCheckedId = '';
					            }
					        } else {
					            messageEl.textContent = 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.';
					            messageEl.className = 'text-sm mt-1 text-red-500';
					            idChecked = false;
					            lastCheckedId = '';
					        }
					    },
					    error: function(xhr, status, error) {
					        messageEl.textContent = 'ì•„ì´ë”” ì¤‘ë³µ í™•ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
					        messageEl.className = 'text-sm mt-1 text-red-500';
					        idChecked = false;
					        lastCheckedId = '';
					    }
					});
				}
				//ì´ë©”ì¼ ì§ì ‘ì…ë ¥ ì…€ë ‰íŠ¸ë°•ìŠ¤
				function res(r){
					if(r ==""){
						$("#o_email2").attr("readonly",false);
					} else {
						$("#o_email2").attr("readonly",true);
					}
					document.getElementById("o_email2").value=r;
				}
		
				// ë¹„ë°€ë²ˆí˜¸ ê°•ë„ ì²´í¬
				document.getElementById('userPw').addEventListener('input', function() {
					const password = this.value;
					const strengthBar = document.getElementById('passwordStrengthBar');
					const strengthText = document.getElementById('passwordStrengthText');
		
					let strength = 0;
					if (password.length >= 8) strength++;
					if (/[a-zA-Z]/.test(password)) strength++;
					if (/[0-9]/.test(password)) strength++;
					if (/[^a-zA-Z0-9]/.test(password)) strength++;
		
					strengthBar.className = 'password-strength';
					
					if (strength <= 1) {
						strengthBar.classList.add('strength-weak');
						strengthText.textContent = 'ì•½í•¨';
					} else if (strength <= 3) {
						strengthBar.classList.add('strength-medium');
						strengthText.textContent = 'ë³´í†µ';
					} else {
						strengthBar.classList.add('strength-strong');
						strengthText.textContent = 'ê°•í•¨';
					}
				});
				// ì‹¤ì‹œê°„ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
				function checkPasswordStrength() {
				    const password = document.getElementById('userPw').value;
				    const messageEl = document.getElementById('passwordMessage');
				    
				    if (!password) {
				        messageEl.textContent = '';
				        return;
				    }
				    
				    const validation = validatePassword(password);
				    
				    if (validation.isValid) {
				        messageEl.textContent = 'âœ“ ì‚¬ìš© ê°€ëŠ¥í•œ ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤.';
				        messageEl.className = 'text-sm mt-1 text-green-500';
				    } else {
				        messageEl.textContent = validation.messages.join(' ');
				        messageEl.className = 'text-sm mt-1 text-red-500';
				    }
				    passConfirmInput();
				}
				// ë¹„ë°€ë²ˆí˜¸ í™•ì¸
				function passConfirmInput(){
					const password = document.getElementById('userPw').value;
					const confirmPassword = document.getElementById('passwordConfirm').value;
					const messageEl = document.getElementById('passwordConfirmMessage');
		
					if (confirmPassword && password !== confirmPassword) {
						messageEl.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
						messageEl.className = 'text-sm mt-1 text-red-500';
					} else if (confirmPassword && password === confirmPassword) {
						messageEl.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.';
						messageEl.className = 'text-sm mt-1 text-green-500';
					} else {
						messageEl.textContent = '';
					}
				}
				
				let isSubmitting = false;
				function memberSave(){
					
					 if (isSubmitting) return; // ğŸš« ì´ë¯¸ ìš”ì²­ ì¤‘
					 
					// í•„ìˆ˜ ê²€ì¦
					if (!idChecked) {
				        alert('ì•„ì´ë”” ì¤‘ë³µ í™•ì¸ì„ í•´ì£¼ì„¸ìš”.');
				        document.getElementById('userId').focus();
				        return false;
				    }
					
					const password = document.getElementById('userPw').value;
					const confirmPassword = document.getElementById('passwordConfirm').value;
					if(!password){
						$("#userPw").focus();
						alert('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
						return;
					}
					
					// âœ… ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì¦ ì¶”ê°€
				    const validation = validatePassword(password);
				    if (!validation.isValid) {
				        alert(validation.messages.join(' '));
				        $("#userPw").focus();
				        return;
				    }
					
					if (password !== confirmPassword) {
						$("#userPw").focus();
						alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
						return;
					}
		
					const userNm = document.getElementById('userNm').value;
					if(!userNm){
						$("#userNm").focus();
						alert('ì´ë¦„ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
						return;
					}
					
					const userMobile = document.getElementById('userMobile').value;
					if(!userMobile){
						$("#userMobile").focus();
						alert('í•¸ë“œí°ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
						return;
					}
					const zipcode = document.getElementById('o_postNum').value;
					if(!zipcode){
						$("#o_postNum").focus();
						alert('ì£¼ì†Œë¥¼ ê²€ìƒ‰í•´ ì£¼ì„¸ìš”.');
						return;
					}
					
					const addr = document.getElementById('o_addr').value;
					if(!addr){
						$("#o_addr").focus();
						alert('ì£¼ì†Œë¥¼ ê²€ìƒ‰í•´ ì£¼ì„¸ìš”.');
						return;
					}
					
					const addrDetail = document.getElementById('o_addrDetail').value;
					if(!addrDetail){
						$("#o_addrDetail").focus();
						alert('ìƒì„¸ì£¼ì†Œë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
						return;
					}
					
					const email = document.getElementById('o_email').value;
					if(!email){
						$("#o_email").focus();
						alert('ì´ë©”ì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
						return;
					}
					
					const email2 = document.getElementById('o_email2').value;
					if(!email2){
						$("#o_email2").focus();
						alert('ì´ë©”ì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
						return;
					}
					document.getElementById("od_email").value=email+"@"+email2;
					// í¼ ë°ì´í„° ìˆ˜ì§‘ - form ìš”ì†Œë¥¼ ì§ì ‘ ê°€ì ¸ì™€ì•¼ í•¨
					let memberVO = $("#memberForm").serializeObject();
					
					isSubmitting = true; // âœ… ì—¬ê¸°ì„œ ì ê¸ˆ
					
					// AJAXë¡œ ì„œë²„ì— ì „ì†¡
				    $.ajax({
				        url: "/rest/member/save", // ì‹¤ì œ API ì—”ë“œí¬ì¸íŠ¸ë¡œ ìˆ˜ì •
				        type: "POST",
				        data: memberVO,
				        dataType: "json",
				        success: function(result) {
				            if (result.responseCode === "SUCCESS") {
								alert(result.data.message);
								if(result.data.RESULT === "0000") window.location.href = '/login'; // ë¡œê·¸ì¸ í˜ì´ì§€ ê²½ë¡œë¡œ ìˆ˜ì •
				            } else {
				                alert(result.message || 'íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
				            }
				        },
				        error: function(xhr, status, error) {
				            alert('íšŒì›ê°€ì… ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. \nê³ ê°ì„¼í„°ì— ë¬¸ì˜í•´ ì£¼ì„¸ìš”.');
				        },
				        complete: function() {
				            isSubmitting = false; // ğŸ”“ ì‹¤íŒ¨ ì‹œë§Œ ë‹¤ì‹œ ì—´ì–´ì¤Œ
				        }
				    });
				}
				
				$(document).on("keyup", ".phoneNumber", function() { 
					$(this).val( $(this).val().replace(/[^0-9]/g, "").replace(/(^02|^0505|^1[0-9]{3}|^0[0-9]{2})([0-9]+)?([0-9]{4})$/,"$1-$2-$3").replace("--", "-") ); 
				});
				enterKey = function(type){
					if (window.event.keyCode == 13) {
						idCheck();
					}
				}
				enterKey2 = function(type){
					if (window.event.keyCode == 13) {
						memberSave();
					}
				}
				// ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬ í•¨ìˆ˜
				function validatePassword(password) {
				    const result = {
				        isValid: true,
				        messages: []
				    };
				    
				    // ê¸¸ì´ ì²´í¬
				    if (password.length < 8 || password.length > 20) {
				        result.isValid = false;
				        result.messages.push('8-20ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
				    }
				    
				    // ì˜ë¬¸ í¬í•¨ ì²´í¬
				    if (!/[a-zA-Z]/.test(password)) {
				        result.isValid = false;
				        result.messages.push('ì˜ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
				    }
				    
				    // í—ˆìš©ë˜ì§€ ì•ŠëŠ” ë¬¸ì ì²´í¬
				    if (/[^a-zA-Z0-9!@#$%^&*()_+]/.test(password)) {
				        result.isValid = false;
				        result.messages.push('í—ˆìš©ë˜ì§€ ì•ŠëŠ” ë¬¸ìê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.');
				    }
				    
				    return result;
				}
			</script>
		</main>
</html>